function speed(){return document.getElementsByName("speed")[0].value}function target(){return"["+document.getElementsByName("galaxy")[0].value+":"+document.getElementsByName("system")[0].value+":"+document.getElementsByName("planet")[0].value+"]"}function setACS(e){document.getElementsByName("fleet_group")[0].value=e}function setACS_target(e){document.getElementsByName("acs_target")[0].value=e}function setTarget(e,t,n,a){document.getElementsByName("galaxy")[0].value=e,document.getElementsByName("system")[0].value=t,document.getElementsByName("planet")[0].value=n,document.getElementsByName("planettype")[0].value=a}function setMission(e){document.getElementsByName("order")[0].selectedIndex=e}function setUnion(e){document.getElementsByName("union2")[0].selectedIndex=e}function setTargetLong(e,t,n,a,s,m){setTarget(e,t,n,a),setMission(s),setUnions(m)}function min(e,t){return(t=+t)<(e=+e)?t:e}function maxspeed(){var e=1e9;for(i=200;i<220;i++)document.getElementsByName("ship"+i)[0]&&1<=+document.getElementsByName("speed"+i)[0].value&&1<=+document.getElementsByName("ship"+i)[0].value&&(e=min(e,document.getElementsByName("speed"+i)[0].value));return e}function distance(){var e=document.getElementsByName("thisgalaxy")[0].value,t=document.getElementsByName("thissystem")[0].value,n=document.getElementsByName("thisplanet")[0].value,a=document.getElementsByName("galaxy")[0].value,s=document.getElementsByName("system")[0].value,m=document.getElementsByName("planet")[0].value;return a-e!=0?2e4*Math.abs(a-e):s-t!=0?5*Math.abs(s-t)*19+2700:m-n!=0?5*Math.abs(m-n)+1e3:5}function duration2(){var e=document.getElementsByName("speedfactor")[0].value;return msp=maxspeed(),sp=speed(),dist=distance(),ret=(35e3/sp*Math.sqrt(10*dist/msp)+10)/e,ret}function duration(){var e=document.getElementsByName("speedfactor")[0].value;return msp=maxspeed(),sp=speed(),dist=distance(),ret=Math.round((35e3/sp*Math.sqrt(10*dist/msp)+10)/e),ret}function consumption2(){var e=0;for(i=200;i<220;i++)document.getElementsByName("ship"+i)[0]&&(e+=document.getElementsByName("consumption"+i)[0].value*document.getElementsByName("ship"+i)[0].value);return speedfactor=document.getElementsByName("speedfactor")[0].value,msp=maxspeed(),sp=speed(),dist=distance(),Math.round(e*dist/35e3*(sp/10+1)*(sp/10+1))+1}function consumption(){var e,t=0;for(msp=maxspeed(),sp=speed(),dist=distance(),dur=duration2(),speedfactor=document.getElementsByName("speedfactor")[0].value,e=200;e<220;e++)document.getElementsByName("ship"+e)[0]&&(shipspeed=document.getElementsByName("speed"+e)[0].value,spd=35e3/(dur*speedfactor-10)*Math.sqrt(10*dist/shipspeed),t+=(spd+document.getElementsByName("ship"+e)[0].value*document.getElementsByName("consumption"+e)[0].value*Math.pow(spd/10+1,2))*dist/35e3+1);return t=Math.round(t)}function probeConsumption(){var e=0;return msp=maxspeed(),sp=speed(),dist=distance(),dur=duration(),speedfactor=document.getElementsByName("speedfactor")[0].value,document.getElementsByName("ship210")[0]&&(shipspeed=document.getElementsByName("speed210")[0].value,spd=35e3/(dur*speedfactor-10)*Math.sqrt(10*dist/shipspeed),e+=document.getElementsByName("consumption210")[0].value*document.getElementsByName("ship210")[0].value*dist/35e3*(spd/10+1)*(spd/10+1)),e=Math.round(e)+1}function unusedProbeStorage(){var e=document.getElementsByName("capacity210")[0].value*document.getElementsByName("ship210")[0].value-probeConsumption();return 0<e?e:0}function storage(){var e=0;for(i=200;i<300;i++)document.getElementsByName("ship"+i)[0]&&1<=+document.getElementsByName("ship"+i)[0].value&&(e+=document.getElementsByName("ship"+i)[0].value*document.getElementsByName("capacity"+i)[0].value);return e*=getStorageFaktor(),document.getElementsByName("ship210")[0]&&(e-=unusedProbeStorage()),e}function fleetInfo(){document.getElementById("speed").innerHTML=10*speed()+"%",document.getElementById("target").innerHTML=target(),document.getElementById("distance").innerHTML=distance();var e=duration(),t=Math.floor(e/3600);e-=3600*t;var n=Math.floor(e/60);e-=60*n,n<10&&(n="0"+n),e<10&&(e="0"+e),document.getElementById("duration").innerHTML=t+":"+n+":"+e+" h";n=storage(),e=consumption();document.getElementById("maxspeed").innerHTML=tsdpkt(maxspeed()),0<=n?(document.getElementById("consumption").innerHTML='<font color="lime">'+e+"</font>",document.getElementById("storage").innerHTML='<font color="lime">'+n+"</font>"):(document.getElementById("consumption").innerHTML='<font color="red">'+e+"</font>",document.getElementById("storage").innerHTML='<font color="red">'+n+"</font>"),calculateTransportCapacity()}function shortInfo(){document.getElementById("distance").innerHTML=tsdpkt(distance());var e=duration(),t=Math.floor(e/3600);e-=3600*t;var n=Math.floor(e/60);e-=60*n,n<10&&(n="0"+n),e<10&&(e="0"+e),document.getElementById("duration").innerHTML=t+":"+n+":"+e+" h";n=storage(),e=consumption();document.getElementById("maxspeed").innerHTML=tsdpkt(maxspeed()),0<=n?(document.getElementById("consumption").innerHTML='<font color="lime">'+tsdpkt(e)+"</font>",document.getElementById("storage").innerHTML='<font color="lime">'+tsdpkt(n)+"</font>"):(document.getElementById("consumption").innerHTML='<font color="red">'+tsdpkt(e)+"</font>",document.getElementById("storage").innerHTML='<font color="red">'+tsdpkt(n)+"</font>")}function setResource(e,t){document.getElementsByName(e)[0]&&(document.getElementsByName("resource"+e)[0].value=t)}function maxResource(e){var t=parseInt(document.getElementsByName("thisresource"+e)[0].value),n=parseInt(document.getElementsByName("resource"+e)[0].value);isNaN(n)&&(n=0),isNaN(t)&&(t=0);var a=storage(),s=parseInt(document.getElementsByName("resource1")[0].value),m=parseInt(document.getElementsByName("resource2")[0].value),o=parseInt(document.getElementsByName("resource3")[0].value);isNaN(s)&&(s=0),isNaN(m)&&(m=0),isNaN(o)&&(o=0);o=Math.max(a-s-m-o,0),t=Math.min(o+n,t);document.getElementsByName("resource"+e)[0]&&(document.getElementsByName("resource"+e)[0].value=t),calculateTransportCapacity()}function maxResources(){var e=storage(),t=document.getElementsByName("thisresource1")[0].value,n=document.getElementsByName("thisresource2")[0].value,a=document.getElementsByName("thisresource3")[0].value;e-t-n-a<0&&(t=Math.min(t,e),n=Math.min(n,e-t),a=Math.min(a,e-t-n)),document.getElementsByName("resource1")[0].value=Math.max(t,0),document.getElementsByName("resource2")[0].value=Math.max(n,0),document.getElementsByName("resource3")[0].value=Math.max(a,0),calculateTransportCapacity()}function maxShip(e){document.getElementsByName(e)[0]&&(document.getElementsByName(e)[0].value=document.getElementsByName("max"+e)[0].value)}function maxShips(){for(i=200;i<220;i++)maxShip("ship"+i)}function noShip(e){document.getElementsByName(e)[0]&&(document.getElementsByName(e)[0].value=0)}function noShips(){for(i=200;i<220;i++)noShip("ship"+i)}function calculateTransportCapacity(){var e=Math.round(Math.abs(document.getElementsByName("resource1")[0].value)),t=Math.round(Math.abs(document.getElementsByName("resource2")[0].value)),n=Math.round(Math.abs(document.getElementsByName("resource3")[0].value));return transportCapacity=storage()-e-t-n,transportCapacity<0?document.getElementById("remainingresources").innerHTML="<font color=red>"+transportCapacity+"</font>":document.getElementById("remainingresources").innerHTML="<font color=lime>"+transportCapacity+"</font>",transportCapacity}function getLayerRef(e,t){if((t=t||window.document).layers){for(var n=0;n<t.layers.length;n++)if(t.layers[n].id==e)return t.layers[n];for(n=0;n<t.layers.length;n++){var a=getLayerRef(e,t.layers[n].document);if(a)return a}return null}return t.all?t.all[e]:t.getElementById?t.getElementById(e):void 0}function setVisibility(e,t){document.layers?e.visibility=1==t?"show":"hide":e.style.visibility=1==t?"visible":"hidden"}function setVisibilityForDivByPrefix(e,t,n){if(n=n||window.document,document.layers)for(var a=0;a<n.layers.length;a++)n.layers[a].id.substr(0,e.length)==e&&setVisibility(n.layers[l],t),setVisibilityForDivByPrefix(e,t,n.layers[a].document);else if(document.all)for(var s=document.all.tags("div"),a=0;a<s.length;a++)s[a].id.substr(0,e.length)==e&&setVisibility(document.all.tags("div")[a].visible);else if(document.getElementsByTagName){s=document.getElementsByTagName("div");for(a=0;a<s.length;a++)s[a].id.substr(0,e.length)==e&&setVisibility(s[a].visible)}}function setPlanet(e){e=e.split(":");document.getElementsByName("galaxy")[0].value=e[0],document.getElementsByName("system")[0].value=e[1],document.getElementsByName("planet")[0].value=e[2],document.getElementsByName("planettype")[0].value=e[3],setMission(e[4])}function setUnions(e){for(galaxy=document.getElementsByName("galaxy")[0].value,system=document.getElementsByName("system")[0].value,planet=document.getElementsByName("planet")[0].value,planettype=document.getElementsByName("planettype")[0].value,thisgalaxy=document.getElementsByName("thisgalaxy")[0].value,thissystem=document.getElementsByName("thissystem")[0].value,thisplanet=document.getElementsByName("thisplanet")[0].value,thisplanettype=document.getElementsByName("thisplanettype")[0].value,spd=document.getElementsByName("speed")[0].value,speedfactor=document.getElementsByName("speedfactor")[0].value,i=0;i<e;i++){var t=document.getElementById("union"+i).innerHTML;time=document.getElementsByName("union"+i+"time")[0].value,targetgalaxy=document.getElementsByName("union"+i+"galaxy")[0].value,targetsystem=document.getElementsByName("union"+i+"system")[0].value,targetplanet=document.getElementsByName("union"+i+"planet")[0].value,targetplanettype=document.getElementsByName("union"+i+"planettype")[0].value,targetgalaxy==galaxy&&targetsystem==system&&targetplanet==planet&&targetplanettype==planettype?(inSpeedLimit=isInSpeedLimit(flightTime(thisgalaxy,thissystem,thisplanet,targetgalaxy,targetsystem,targetplanet,spd,speedfactor),time),2==inSpeedLimit?document.getElementById("union"+i).innerHTML='<font color="lime">'+t+"</font>":1==inSpeedLimit?document.getElementById("union"+i).innerHTML='<font color="orange">'+t+"</font>":document.getElementById("union"+i).innerHTML='<font color="red">'+t+"</font>"):document.getElementById("union"+i).innerHTML='<font color="#00a0ff">'+t+"</font>"}}function isInSpeedLimit(e,t){var n=new Date;return e<1.5*(t-(n=Math.round(n/1e3)))?2:e<t-n?1:0}function flightTime(e,t,n,a,s,m,o,u,l){return dist=e-a!=0?2e4*Math.abs(e-a):t-s!=0?5*Math.abs(t-s)*19+2700:n-m!=0?5*Math.abs(n-m)+1e3:5,Math.round((35e3/o*Math.sqrt(10*dist/u)+10)/l)}function showCoords(){document.getElementsByName("speed")[0].disabled=!1,document.getElementsByName("galaxy")[0].disabled=!1,document.getElementsByName("system")[0].disabled=!1,document.getElementsByName("planet")[0].disabled=!1,document.getElementsByName("planettype")[0].disabled=!1,document.getElementsByName("shortlinks")[0].disabled=!1}function hideCoords(){document.getElementsByName("speed")[0].disabled=!0,document.getElementsByName("galaxy")[0].disabled=!0,document.getElementsByName("system")[0].disabled=!0,document.getElementsByName("planet")[0].disabled=!0,document.getElementsByName("planettype")[0].disabled=!0,document.getElementsByName("shortlinks")[0].disabled=!0}function showOrders(){document.getElementsByName("order")[0].disabled=!1}function hideOrders(){document.getElementsByName("order")[0].disabled=!0}function showResources(){document.getElementsByName("resource1")[0].disabled=!1,document.getElementsByName("resource2")[0].disabled=!1,document.getElementsByName("resource3")[0].disabled=!1,document.getElementsByName("holdingtime")[0].disabled=!1}function hideResources(){document.getElementsByName("resource1")[0].disabled=!0,document.getElementsByName("resource2")[0].disabled=!0,document.getElementsByName("resource3")[0].disabled=!0,document.getElementsByName("holdingtime")[0].disabled=!0}function setShips(e,t,n,a,s,m,o,u,l,i,d,r,c,y,g,p,B){setNumber("202",e),setNumber("203",t),setNumber("204",n),setNumber("205",a),setNumber("206",s),setNumber("207",m),setNumber("208",o),setNumber("209",u),setNumber("210",l),setNumber("211",i),setNumber("213",d),setNumber("214",r),setNumber("215",c)}function setNumber(e,t){void 0!==document.getElementsByName("ship"+e)[0]&&(document.getElementsByName("ship"+e)[0].value=t)}function tsdpkt(e){for(r="",vz="",e<0&&(vz="-"),e=abs(e),r=e%1e3;1e3<=e;)k1=e%1e3<100?"0":"",e%1e3<10&&(k1="00"),e%1e3==0&&(k1="00"),e=abs((e-e%1e3)/1e3),r=e%1e3+"."+k1+r;return r=vz+r,r}function abs(e){return e<0?-e:e}